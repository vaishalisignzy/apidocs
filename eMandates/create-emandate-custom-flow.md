# Create eMandate: Custom Flow

## Introduction

The Auth Link received in the response will be redirected to a link. Once the authorization is complete, your customer will be redirected to Signzy URL. Store the subReferenceId as this is the unique id generated by Signzy for the subscription and will be required for subsequent operations.

## API Use-case

The purpose is to create an e-mandate.  Same end-point can be used to access either of the flows (CUSTOM and DEFAULT) by changing the variable "emandateFlow" value.

How to use the API
------------------

The users need to give inputs as per the input guidelines below.

## API Input Guidelines

* Pass a valid JSON body
* Pass a valid Authorization Key in headers

## Input parameters & Sample cURL request

{% tabs %}
{% tab title="Input Parameters" %}


| Parameter Name        | Description                                                                                                                                                                                                                             | Required/Optional                |   |   |
| --------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------- | - | - |
| customerName          | contains the essential input data                                                                                                                                                                                                       | Optional                         |   |   |
| customerEmail         | contains the image url                                                                                                                                                                                                                  | Required                         |   |   |
| customerPhone         | contains the fields it matches data from.                                                                                                                                                                                               | Required                         |   |   |
| mandateType           | Accepted values are PERIODIC or ON\_DEMAND. PERIODIC - Payments are triggered automatically at fixed intervals defined by the merchant. ON\_DEMAND - Merchant needs to trigger/charge the customer explicitly with the required amount. | Required                         |   |   |
| mandateFlow           | Type of flow. Accepted values are CUSTOM or DEFAULT. If left blank, default flow will be used.                                                                                                                                          | Optional                         |   |   |
| maxCycles             | Maximum number of debits set for the plan. The subscription will automatically change to COMPLETED status once this limit is reached. Default value is infinity.                                                                        | Optional                         |   |   |
| description           | A brief note about the eMandate                                                                                                                                                                                                         | Optional                         |   |   |
| notificationChannels  | Possible values: EMAIL, SMS. The checkout link is sent through the given notification channels.                                                                                                                                         | Optional                         |   |   |
| expiresOn             | (Date,pattern :yyyy-MM-dd HH:mm:ss) The last date till which the eMandate stands valid. After this date, the status of eMandate will be changed to COMPLETED. Default value is 2 years from date of eMandate creation.                  | Optional                         |   |   |
| authAmount            | (Decimal upto 2 precision) This is the amount that will be charged to authenticate the payment and is applicable for UPI and Cards only. The default amount is Re. 1/-. Note: This amount is not refunded to the customer.              | Optional                         |   |   |
| firstChargeDate       | (Date,pattern :yyyy-MM-dd) This will be the date at which the first payment takes place. Applicable for Periodic eMandate only. Minimum can only be 2 days later from today's date.                                                     | Required for PERIODIC eMandate   |   |   |
| intervalType          | The type of interval for a PERIODIC plan. Accepted values are DAY, WEEK, MONTH, YEAR. This is a conditional parameter. Not applicable for on-demand eMandates.                                                                          | Required for PERIODIC eMandate   |   |   |
| intervals             | Number of intervals of intervalType between every subscription payment. For example, to charge a customer bi-weekly use intervalType as “week” and intervals as 2. Default value is 1. Not applicable for on-demand plans.              | Optional for PERIODIC plan.      |   |   |
| amount                | The amount to be charged for PERIODIC plan. Not applicable for on-demand plans.                                                                                                                                                         | Required for PERIODIC plan.      |   |   |
| maxAmount             | The maximum amount to be charged for ON\_DEMAND plan. This is a conditional parameter. Not applicable for periodic plans.                                                                                                               | Required for ON\_DEMAND eMandate |   |   |
| callbackUrl           | URL to which eMandate status change and authentication status change will be posted                                                                                                                                                     | Optional                         |   |   |
| emandateAccountHolder | Account holder name.                                                                                                                                                                                                                    | Required for CUSTOM mandateFlow  |   |   |
| emandateAccountNumber |                                                                                                                                                                                                                                         | Required for CUSTOM mandateFlow  |   |   |
| emandateBankId        | The bank with the account is held. Check reference for the possible values. This is a conditional parameter, applicable only for paymentOption "emandate".                                                                              | Required for CUSTOM mandateFlow  |   |   |
| emandateAuthMode      | Possible values - debitCard/netbanking.                                                                                                                                                                                                 | Required for CUSTOM mandateFlow  |   |   |
| emandateAccountType   | Possible values - SAVINGS/CURRENT. Default is SAVINGS. Not applicable for DEFAULT mandateFlow                                                                                                                                           | Optional for CUSTOM mandateFlow  |   |   |


{% endtab %}

{% tab title="Sample cURL request" %}
```
curl --location --request POST 'https://api.signzy.app/api/v3/eNach/eMandates' \
--header 'Authorization: ...key...' \
--header 'Content-Type: application/json' \
--data-raw '{
    "customerName": "..customerName..",
    "customerEmail": "..customerEmail..",
    "customerPhone": "..customerPhone..",
    "mandateType": "..ON_DEMAND/PERIODIC..",
    "mandateFlow": "..DEFAULT/CUSTOM..",
    "maxCycles":1,
    "description":"..description..",
    "expiresOn":"YYYY-MM-DD HH:mm:ss",
    "authAmount":1,
    "firstChargeDate": "YYYY-MM-DD",
    "intervalType": "..DAY/WEEK/MONTH/YEAR",
    "maxAmount": 100,
    "emandateAccountHolder": "..emandateAccountHolder..",
    "emandateAccountNumber": "..emandateAccountNumber..",
    "emandateBankId": "..emandateBankId..",
    "emandateAuthMode": "..emandateAuthMode..",
    "emandateAccountType": "SAVINGS/CURRENT"
}'
```


{% endtab %}
{% endtabs %}

## **Possible Values for Bank ID**

| If emandate\_authMode is NetBanking:	                                                                                                                                                                                                                            | If emandate\_authMode is debitCard:                                                                                                                                                                                    |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| BARB, CBIN, CIUB, CNRB, COSB, DEUT, DLXB, ESFB, FDRL, HDFC, IBKL, ICIC, IDFB, INDB, KARB, KKBK, MAHB, PUNB, PYTM, RATN, SBIN, SCBL, TMBL, USFB, UTIB, YESB, SIBL, DBSS, JSFB, HSBC, KVBL, CITI, DCBL, BDBL, IDIB, UBIN, CSBK, VARA, KVGB, APGB, AUBL, IOBA, PSIB | ANDB, AUBL, CITI, DCBL, DEUT, DLXB, ESFB, FDRL, HDFC, ICIC, IDFB, INDB, KARB, KKBK, MAHB, PUNB, PYTM, RATN, SBIN, SIBL, USFB, YESB, DBSS, TMBL, UTIB, BARB, JSFB, SCBL, UBIN, CSBK, CNSX, SHIX, NCBL, KNSB, BKID, CLBL |

### Mapping for BankId

| Bank ID | Bank Name                                         |
| ------- | ------------------------------------------------- |
| CITI    | CITIBANK N A                                      |
| DCBL    | DCB BANK LTD                                      |
| BDBL    | BANDHAN BANK LTD                                  |
| IDIB    | INDIAN BANK                                       |
| BARB    | BANK OF BARODA                                    |
| CBIN    | CENTRAL BANK OF INDIA                             |
| CIUB    | CITY UNION BANK LTD                               |
| CNRB    | CANARA BANK                                       |
| COSB    | Cosmos Bank                                       |
| DEUT    | DEUTSCHE BANK AG                                  |
| DLXB    | DHANALAXMI BANK                                   |
| ESFB    | EQUITAS SMALL FINANCE BANK LTD                    |
| FDRL    | FEDERAL BANK                                      |
| HDFC    | HDFC BANK LTD                                     |
| IBKL    | IDBI BANK LTD                                     |
| ICIC    | ICICI BANK LTD                                    |
| IDFB    | IDFC FIRST Bank                                   |
| INDB    | INDUSIND BANK                                     |
| KARB    | KARNATAKA BANK LTD                                |
| KKBK    | KOTAK MAHINDRA BANK LTD                           |
| MAHB    | BANK OF MAHARASHTRA                               |
| PUNB    | PUNJAB NATIONAL BANK                              |
| TMBL    | TAMILNAD MERCANTILE BANK LTD                      |
| USFB    | UJJIVAN SMALL FINANCE BANK LTD                    |
| UTIB    | AXIS BANK                                         |
| PYTM    | PAYTM PAYMENTS BANK LTD                           |
| RATN    | RBL BANK LIMITED                                  |
| SBIN    | STATE BANK OF INDIA                               |
| SCBL    | STANDARD CHARTERED BANK                           |
| YESB    | YES BANK                                          |
| SIBL    | SOUTH INDIAN BANK                                 |
| DBSS    | DBS BANK INDIA LTD                                |
| JSFB    | JANA SMALL FINANCE BANK LTD                       |
| HSBC    | THE HONGKONG AND SHANGHAI BANKING CORPORATION LTD |
| KVBL    | KARUR VYSA BANK                                   |
| UBIN    | UNION BANK OF INDIA                               |
| CSBK    | CSB BANK LTD                                      |
| VARA    | THE VARACHHA CO OP BANK LTD                       |
| KVGB    | KARNATAKA VIKAS GRAMEENA BANK                     |
| APGB    | ANDHRA PRAGATHI GRAMEENA BANK                     |
| CNSX    | THE CHEMBUR NAGARIK SAHAKARI BANK                 |
| SHIX    | SHIVALIK SMALL FINANCE BANK LTD                   |
| NCBL    | THE NATIONAL CO OP BANK LTD                       |
| KNSB    | KURLA NAGARIK SAHAKARI BANK LTD                   |
| AUBL    | AU SMALL FINANCE BANK                             |
| BKID    | BANK OF INDIA                                     |
| PSIB    | PUNJAB AND SIND BANK                              |
| IOBA    | INDIAN OVERSEAS BANK                              |
| CLBL    | CAPITAL SMALL FINANCE BANK LTD                    |

\


## Output Parameters and Sample API response

{% tabs %}
{% tab title="Output Parameters" %}
| Parameter Name        | Description                                                                                                                                                              |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| result.status         | eMandate creation status                                                                                                                                                 |
| result.message        | eMandate creation message                                                                                                                                                |
| result.subReferenceId | A unique ID generated for eMandates. This will be used to identify eMandates.                                                                                            |
| result.authLink       | Authorization link. In case of DEFAULT flow, it will redirect to website for filling in payment details. For CUSTOM flow, it will redirect directly to the consent link. |
| result.subStatus      | eMandate status                                                                                                                                                          |


{% endtab %}

{% tab title="Sample API Response" %}
```
{
  "status": "OK",
  "message": "Subscription created successfully",
  "subReferenceId": 9999999,
  "authLink": "https://cfre.in/abcd",
  "subStatus": "INITIALIZED"
}
```
{% endtab %}
{% endtabs %}

## HTTP Response codes&#x20;

| Status code | Description                     |
| ----------- | ------------------------------- |
| **200**     | All response details are valid  |
| **404**     | Not found                       |
| **400**     | Bad Request                     |
| **401**     | Unauthorized                    |
| **403**     | Forbidden                       |
| **422**     | Unprocessable entity            |



{% swagger baseUrl="https://api.signzy.app" path="/api/v3/eNach/eMandates" method="post" summary="Create eMandate Custom Flow" %}
{% swagger-description %}
This method creates a new eMandate
{% endswagger-description %}

{% swagger-parameter in="body" name="customerName" type="" required="false" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="customerEmail" type="" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="customerPhone" required="true" type="" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="mandateName" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="mandateType" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="mandateFlow" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="maxCycles" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="description" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="notificationChannels" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="returnUrl" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="expiresOn" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="authAmount" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="amount" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="intervalType" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="intervals" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="firstChargeDate" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="maxAmount" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="emandateAccountHolder" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="emandateAccountNumber" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="emandateBankId" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="emandateAuthMode" required="true" %}

{% endswagger-parameter %}

{% swagger-parameter in="body" name="emandateAccountType" %}

{% endswagger-parameter %}

{% swagger-response status="200" description="Successful eMandate creation" %}
```
{
    "result": {
        "status": "OK",
        "message": "..message..",
        "subReferenceId": ..subReferenceId..,
        "authLink": "..authLink..",
        "subStatus": "..eMandateStatus.."
    }
}
```
{% endswagger-response %}
{% endswagger %}

|   |
| - |

